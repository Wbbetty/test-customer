{"version":3,"sources":["webpack:///./src/agent/view/Conversations.vue?54d8","webpack:///src/agent/view/Conversations.vue","webpack:///./src/agent/view/Conversations.vue?11df","webpack:///./src/agent/view/Conversations.vue","webpack:///./src/agent/images/default.png","webpack:///./src/agent/lib/utils.js","webpack:///./src/agent/view/Conversations.vue?b716"],"names":["render","_vm","this","_c","_self","staticClass","_v","_s","pendingConversations","length","_l","conversation","key","class","checked","id","$route","query","on","$event","chat","data","attrs","avatar","renderCustomerName","lastMessage","type","payload","text","_e","conversations","preventDefault","stopPropagation","e","showRightClickMenu","apply","arguments","unread","formatDate","timestamp","status","senderId","currentAgent","transferTo","name","senderData","rightClickMenu","style","x","y","topConversation","top","deleteConversation","staticRenderFns","visible","document","addEventListener","hideRightClickMenu","global","listenConversationUpdate","loadConversations","goEasy","im","off","GoEasy","IM_EVENT","CONVERSATIONS_UPDATED","renderLatestConversations","PENDING_CONVERSATIONS_UPDATED","renderPendingConversations","methods","customer","mark","indexOf","mobileNumber","onSuccess","result","content","onFailed","error","console","log","code","latestConversations","customerId","$router","push","path","pageX","pageY","description","confirmResult","confirm","removeConversation","component","module","exports","t","Date","now","time","str","getMonth","getDate","getHours","getMinutes","formateFullDate","getFullYear","getSeconds","formateTime","second","minute","hour","day","getTime","diffValue","secondC","minC","hourC","dayC","parseInt"],"mappings":"uHAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,0BAA0B,CAACF,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACF,EAAG,MAAM,CAACE,YAAY,0BAA0B,CAACF,EAAG,MAAM,CAACE,YAAY,2BAA2B,CAACJ,EAAIK,GAAG,OAAOL,EAAIM,GAAGN,EAAIO,qBAAqBC,WAAWN,EAAG,MAAM,CAACE,YAAY,0BAA0BJ,EAAIS,GAAIT,EAAwB,sBAAE,SAASU,EAAaC,GAAK,OAAOT,EAAG,MAAM,CAACS,IAAIA,EAAIP,YAAY,oBAAoBQ,MAAM,CAACC,QAAQH,EAAaI,KAAOd,EAAIe,OAAOC,MAAMF,IAAIG,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOlB,EAAImB,KAAKT,EAAaI,OAAO,CAACZ,EAAG,MAAM,CAACE,YAAY,aAAa,CAAEM,EAAaU,KAAW,OAAElB,EAAG,MAAM,CAACE,YAAY,cAAciB,MAAM,CAAC,IAAMX,EAAaU,KAAKE,UAAUpB,EAAG,MAAM,CAACE,YAAY,cAAciB,MAAM,CAAC,IAAM,EAAQ,aAA8BnB,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACJ,EAAIK,GAAGL,EAAIM,GAAGN,EAAIuB,mBAAmBb,EAAaU,UAA6C,SAAlCV,EAAac,YAAYC,KAAiBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAGL,EAAIM,GAAGI,EAAac,YAAYE,QAAQC,MAAM,OAA0C,UAAlCjB,EAAac,YAAYC,KAAkBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,cAAiD,UAAlCK,EAAac,YAAYC,KAAkBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,cAAiD,UAAlCK,EAAac,YAAYC,KAAkBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,cAAiD,UAAlCK,EAAac,YAAYC,KAAkBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,kBAAkBL,EAAI4B,YAAW,KAAK1B,EAAG,MAAM,CAACE,YAAY,0BAA0B,CAACF,EAAG,MAAM,CAACE,YAAY,2BAA2B,CAACJ,EAAIK,GAAG,OAAOL,EAAIM,GAAGN,EAAI6B,cAAcrB,WAAYR,EAAI6B,cAAoB,OAAE3B,EAAG,MAAM,CAACE,YAAY,0BAA0BJ,EAAIS,GAAIT,EAAiB,eAAE,SAASU,EAAaC,GAAK,OAAOT,EAAG,MAAM,CAACS,IAAIA,EAAIP,YAAY,oBAAoBQ,MAAM,CAACC,QAAQH,EAAaI,KAAOd,EAAIe,OAAOC,MAAMF,IAAIG,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOlB,EAAImB,KAAKT,EAAaI,KAAK,YAAc,SAASI,GAAyD,OAAjDA,EAAOY,iBAAiBZ,EAAOa,mBAA0BC,GAAKhC,EAAIiC,mBAAmBD,EAAEtB,IAAewB,MAAM,KAAMC,cAAc,CAACjC,EAAG,MAAM,CAACE,YAAY,aAAa,CAAEM,EAAaU,KAAW,OAAElB,EAAG,MAAM,CAACE,YAAY,cAAciB,MAAM,CAAC,IAAMX,EAAaU,KAAKE,UAAUpB,EAAG,MAAM,CAACE,YAAY,cAAciB,MAAM,CAAC,IAAM,EAAQ,WAA6BX,EAAmB,OAAER,EAAG,OAAO,CAACE,YAAY,mBAAmB,CAACJ,EAAIK,GAAGL,EAAIM,GAAGI,EAAa0B,WAAWpC,EAAI4B,OAAO1B,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,MAAM,CAACE,YAAY,iBAAiB,CAACF,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACJ,EAAIK,GAAGL,EAAIM,GAAGN,EAAIuB,mBAAmBb,EAAaU,UAAUlB,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACJ,EAAIK,GAAGL,EAAIM,GAAGN,EAAIqC,WAAW3B,EAAac,YAAYc,iBAAiBpC,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAAsC,YAApCM,EAAac,YAAYe,OAAsBrC,EAAG,MAAM,CAACE,YAAY,sBAAsBJ,EAAI4B,KAA0C,SAApClB,EAAac,YAAYe,OAAmBrC,EAAG,MAAM,CAACE,YAAY,qBAAqBJ,EAAI4B,KAAwC,SAAlClB,EAAac,YAAYC,KAAiBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAGL,EAAIM,GAAGI,EAAac,YAAYE,QAAQC,MAAM,OAA0C,UAAlCjB,EAAac,YAAYC,KAAkBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,cAAiD,UAAlCK,EAAac,YAAYC,KAAkBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,cAAiD,UAAlCK,EAAac,YAAYC,KAAkBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,cAAiD,UAAlCK,EAAac,YAAYC,KAAkBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,kBAAqD,WAAlCK,EAAac,YAAYC,KAAmBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,aAAgD,cAAlCK,EAAac,YAAYC,KAAsBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,WAA8C,gBAAlCK,EAAac,YAAYC,KAAwBvB,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,IAAIL,EAAIM,GAAGI,EAAac,YAAYgB,WAAaxC,EAAIyC,aAAa3B,GAAK,OAASJ,EAAac,YAAYE,QAAQgB,WAAWtB,KAAKuB,KAAO,QAAUjC,EAAac,YAAYoB,WAAWD,KAAO,OAAO,OAAOzC,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACJ,EAAIK,GAAG,sBAAqB,GAAGL,EAAI4B,OAAQ5B,EAAI6C,eAAsB,QAAE3C,EAAG,MAAM,CAACE,YAAY,aAAa0C,MAAM,CAAE,KAAQ9C,EAAI6C,eAAeE,EAAI,KAAM,IAAO/C,EAAI6C,eAAeG,EAAI,OAAQ,CAAC9C,EAAG,MAAM,CAACE,YAAY,cAAca,GAAG,CAAC,MAAQjB,EAAIiD,kBAAkB,CAACjD,EAAIK,GAAGL,EAAIM,GAAGN,EAAI6C,eAAenC,aAAawC,IAAM,OAAS,SAAShD,EAAG,MAAM,CAACE,YAAY,cAAca,GAAG,CAAC,MAAQjB,EAAImD,qBAAqB,CAACnD,EAAIK,GAAG,YAAYL,EAAI4B,OAAO1B,EAAG,MAAM,CAACE,YAAY,qBAAqB,CAACF,EAAG,cAAc,CAACS,IAAIX,EAAIe,OAAOC,MAAMF,MAAM,MAE5nJsC,EAAkB,G,YC8GL,GACbT,KAAM,eACN,OACE,MAAO,CACLpC,qBAAsB,GACtBsB,cAAe,GAEfgB,eAAgB,CACdnC,aAAc,KACd2C,SAAS,EACTN,EAAG,KACHC,EAAG,MAELP,aAAc,OAGlB,UAEEa,SAASC,iBAAiB,QAAS,KACjCtD,KAAKuD,uBAEPvD,KAAKwC,aAAexC,KAAKwD,OAAOhB,aAChCxC,KAAKyD,2BACLzD,KAAK0D,qBAEP,gBACE1D,KAAKwD,OAAOG,OAAOC,GAAGC,IAAI7D,KAAKwD,OAAOM,OAAOC,SAASC,sBAAuBhE,KAAKiE,2BAClFjE,KAAKwD,OAAOG,OAAOC,GAAGC,IAAI7D,KAAKwD,OAAOM,OAAOC,SAASG,8BAA+BlE,KAAKmE,6BAE5FC,QAAS,CACPhC,WAAA,OACA,mBAAoBiC,GAClB,OAAIA,EAASC,KACJD,EAASC,MAC0B,IAAjCD,EAAS3B,KAAK6B,QAAQ,OAAgBF,EAASG,eAAiBH,EAAS3B,KAC3E2B,EAASG,aAEXH,EAASG,cAAgBH,EAAS3B,MAE3C,oBACE1C,KAAKwD,OAAOG,OAAOC,GAAGtD,qBAAqB,CACzCmE,UAAYC,IACV1E,KAAKmE,2BAA2BO,EAAOC,UAEzCC,SAAWC,IACTC,QAAQC,IAAI,mBAAqBF,EAAMG,KAAO,WAAaH,EAAMF,YAGrE3E,KAAKwD,OAAOG,OAAOC,GAAGqB,oBAAoB,CACxCR,UAAYC,IACV1E,KAAKiE,0BAA0BS,EAAOC,UAExCC,SAAWC,IACTC,QAAQC,IAAI,mBAAqBF,EAAMG,KAAO,WAAaH,EAAMF,aAIvE,2BAEE3E,KAAKwD,OAAOG,OAAOC,GAAG5C,GAAGhB,KAAKwD,OAAOM,OAAOC,SAASC,sBAAuBhE,KAAKiE,2BACjFjE,KAAKwD,OAAOG,OAAOC,GAAG5C,GAAGhB,KAAKwD,OAAOM,OAAOC,SAASG,8BAA+BlE,KAAKmE,6BAE3F,2BAA2BQ,GACzB3E,KAAKM,qBAAuBqE,EAAQ/C,eAEtC,0BAA0B+C,GACxB3E,KAAK4B,cAAgB+C,EAAQ/C,eAE/B,KAAKsD,GACHlF,KAAKmF,QAAQC,KAAK,CAChBC,KAAM,4BACNtE,MAAO,CACLF,GAAIqE,MAIV,mBAAmBnD,EAAGtB,GACpBT,KAAK4C,eAAenC,aAAeA,EACnCT,KAAK4C,eAAeQ,SAAU,EAC9BpD,KAAK4C,eAAeE,EAAIf,EAAEuD,MAC1BtF,KAAK4C,eAAeG,EAAIhB,EAAEwD,OAE5B,qBACEvF,KAAK4C,eAAeQ,SAAU,GAEhC,kBACE,IAAI3C,EAAeT,KAAK4C,eAAenC,aACnC+E,EAAc/E,EAAawC,IAAM,OAAS,KAC9CjD,KAAKwD,OAAOG,OAAOC,GAAGZ,gBAAgB,CACpCC,KAAMxC,EAAawC,IACnBxC,aAAcA,EACdgE,UAAW,WACTK,QAAQC,IAAIS,EAAa,OAE3BZ,SAAU,SAAUC,GAClBC,QAAQC,IAAIS,EAAa,MAAOX,OAItC,qBACE,IAAIY,EAAgBC,QAAQ,gBACR,IAAhBD,GACFzF,KAAKwD,OAAOG,OAAOC,GAAG+B,mBAAmB,CACvClF,aAAcT,KAAK4C,eAAenC,aAClCgE,UAAW,WACTK,QAAQC,IAAI,WAEdH,SAAU,SAAUC,GAClBC,QAAQC,IAAIF,SC5NkL,I,wBCQxMe,EAAY,eACd,EACA9F,EACAqD,GACA,EACA,KACA,WACA,MAIa,aAAAyC,E,gCCnBfC,EAAOC,QAAU,IAA0B,4B,oCCKpC,SAAS1D,EAAW2D,GACvBA,EAAIA,GAAKC,KAAKC,MACd,IAAIC,EAAO,IAAIF,KAAKD,GAChBI,EAAMD,EAAKE,WAAa,EAAI,KAAOF,EAAKE,WAAa,GAAKF,EAAKE,WAAa,EAOhF,OANAD,GAAO,IACPA,GAAOD,EAAKG,UAAY,GAAK,IAAMH,EAAKG,UAAYH,EAAKG,UACzDF,GAAO,IACPA,GAAOD,EAAKI,WACZH,GAAO,IACPA,GAAOD,EAAKK,aAAe,GAAK,IAAML,EAAKK,aAAeL,EAAKK,aACxDJ,EAQJ,SAASK,EAAgBT,GAC5BA,EAAIA,GAAKC,KAAKC,MACd,IAAIC,EAAO,IAAIF,KAAKD,GAChBI,EAAMD,EAAKO,cAWf,OAVAN,GAAO,IACPA,GAAOD,EAAKE,WAAa,EAAI,KAAOF,EAAKE,WAAa,GAAKF,EAAKE,WAAa,EAC7ED,GAAO,IACPA,GAAOD,EAAKG,UAAY,GAAK,IAAMH,EAAKG,UAAYH,EAAKG,UACzDF,GAAO,IACPA,GAAOD,EAAKI,WACZH,GAAO,IACPA,GAAOD,EAAKK,aAAe,GAAK,IAAML,EAAKK,aAAeL,EAAKK,aAC/DJ,GAAO,IACPA,GAAOD,EAAKQ,aAAe,GAAK,IAAMR,EAAKQ,aAAeR,EAAKQ,aACxDP,EAQJ,SAASQ,EAAYT,GACxB,MAAMU,EAAS,IACTC,EAAkB,GAATD,EACTE,EAAgB,GAATD,EACPE,EAAa,GAAPD,EACNb,GAAM,IAAID,MAAOgB,UACjBC,EAAYhB,EAAMC,EAGlBgB,EAAUD,EAAYL,EACtBO,EAAOF,EAAYJ,EACnBO,EAAQH,EAAYH,EACpBO,EAAOJ,EAAYF,EAEzB,OAAIM,GAAQ,EACDC,SAASD,GAAQ,IACjBD,GAAS,EACTE,SAASF,GAAS,KAClBD,GAAQ,EACRG,SAASH,GAAQ,KACjBD,GAAW,EACXI,SAASJ,GAAW,IAEpB,KApEf,uG,yDCAA","file":"js/chunk-8f4063ae.ea053edb.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"conversation-container\"},[_c('div',{staticClass:\"conversation-list\"},[_c('div',{staticClass:\"conversation-list-item\"},[_c('div',{staticClass:\"conversation-list-title\"},[_vm._v(\"待接入 \"+_vm._s(_vm.pendingConversations.length))]),_c('div',{staticClass:\"conversation-list-body\"},_vm._l((_vm.pendingConversations),function(conversation,key){return _c('div',{key:key,staticClass:\"conversation-item\",class:{checked:conversation.id === _vm.$route.query.id},on:{\"click\":function($event){return _vm.chat(conversation.id)}}},[_c('div',{staticClass:\"item-head\"},[(conversation.data.avatar)?_c('img',{staticClass:\"item-avatar\",attrs:{\"src\":conversation.data.avatar}}):_c('img',{staticClass:\"item-avatar\",attrs:{\"src\":require(\"../images/default.png\")}})]),_c('div',{staticClass:\"item-info\"},[_c('div',{staticClass:\"item-info-name\"},[_vm._v(_vm._s(_vm.renderCustomerName(conversation.data)))]),(conversation.lastMessage.type === 'text')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(_vm._s(conversation.lastMessage.payload.text)+\" \")]):(conversation.lastMessage.type === 'image')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\" [图片消息] \")]):(conversation.lastMessage.type === 'video')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\" [视频消息] \")]):(conversation.lastMessage.type === 'audio')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\" [语音消息] \")]):(conversation.lastMessage.type === 'order')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\" [自定义消息:订单] \")]):_vm._e()])])}),0)]),_c('div',{staticClass:\"conversation-list-item\"},[_c('div',{staticClass:\"conversation-list-title\"},[_vm._v(\"已接入 \"+_vm._s(_vm.conversations.length))]),(_vm.conversations.length)?_c('div',{staticClass:\"conversation-list-body\"},_vm._l((_vm.conversations),function(conversation,key){return _c('div',{key:key,staticClass:\"conversation-item\",class:{checked:conversation.id === _vm.$route.query.id},on:{\"click\":function($event){return _vm.chat(conversation.id)},\"contextmenu\":function($event){$event.preventDefault();$event.stopPropagation();return (e => _vm.showRightClickMenu(e,conversation)).apply(null, arguments)}}},[_c('div',{staticClass:\"item-head\"},[(conversation.data.avatar)?_c('img',{staticClass:\"item-avatar\",attrs:{\"src\":conversation.data.avatar}}):_c('img',{staticClass:\"item-avatar\",attrs:{\"src\":require(\"../images/default.png\")}}),(conversation.unread)?_c('span',{staticClass:\"item-unread-num\"},[_vm._v(_vm._s(conversation.unread))]):_vm._e()]),_c('div',{staticClass:\"item-info\"},[_c('div',{staticClass:\"item-info-top\"},[_c('div',{staticClass:\"item-info-name\"},[_vm._v(_vm._s(_vm.renderCustomerName(conversation.data)))]),_c('div',{staticClass:\"item-info-time\"},[_vm._v(_vm._s(_vm.formatDate(conversation.lastMessage.timestamp)))])]),_c('div',{staticClass:\"item-info-bottom\"},[(conversation.lastMessage.status === 'sending')?_c('div',{staticClass:\"item-info-sending\"}):_vm._e(),(conversation.lastMessage.status === 'fail')?_c('div',{staticClass:\"item-info-failed\"}):_vm._e(),(conversation.lastMessage.type === 'text')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(_vm._s(conversation.lastMessage.payload.text)+\" \")]):(conversation.lastMessage.type === 'image')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\" [图片消息] \")]):(conversation.lastMessage.type === 'video')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\" [视频消息] \")]):(conversation.lastMessage.type === 'audio')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\" [语音消息] \")]):(conversation.lastMessage.type === 'order')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\" [自定义消息:订单] \")]):(conversation.lastMessage.type === 'CS_END')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\" 会话已结束 \")]):(conversation.lastMessage.type === 'CS_ACCEPT')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\"接入成功 \")]):(conversation.lastMessage.type === 'CS_TRANSFER')?_c('div',{staticClass:\"item-info-message\"},[_vm._v(\" \"+_vm._s(conversation.lastMessage.senderId === _vm.currentAgent.id ? `已转接给` + conversation.lastMessage.payload.transferTo.data.name : '已接入来自' + conversation.lastMessage.senderData.name + '的转接')+\" \")]):_c('div',{staticClass:\"item-info-message\"},[_vm._v(\"[未识别内容]\")])])])])}),0):_vm._e()]),(_vm.rightClickMenu.visible)?_c('div',{staticClass:\"action-box\",style:({'left': _vm.rightClickMenu.x + 'px', 'top': _vm.rightClickMenu.y + 'px'})},[_c('div',{staticClass:\"action-item\",on:{\"click\":_vm.topConversation}},[_vm._v(_vm._s(_vm.rightClickMenu.conversation.top ? '取消置顶' : '置顶'))]),_c('div',{staticClass:\"action-item\",on:{\"click\":_vm.deleteConversation}},[_vm._v(\"删除聊天\")])]):_vm._e()]),_c('div',{staticClass:\"conversation-main\"},[_c('router-view',{key:_vm.$route.query.id})],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"conversation-container\">\n    <div class=\"conversation-list\">\n      <div class=\"conversation-list-item\">\n        <div class=\"conversation-list-title\">待接入 {{ pendingConversations.length }}</div>\n        <div class=\"conversation-list-body\">\n          <div\n            v-for=\"(conversation, key) in pendingConversations\"\n            :key=\"key\" :class=\"{checked:conversation.id === $route.query.id}\"\n            class=\"conversation-item\"\n            @click=\"chat(conversation.id)\"\n          >\n            <div class=\"item-head\">\n              <img v-if=\"conversation.data.avatar\" class=\"item-avatar\" :src=\"conversation.data.avatar\"/>\n              <img v-else class=\"item-avatar\" src=\"../images/default.png\"/>\n            </div>\n            <div class=\"item-info\">\n              <div class=\"item-info-name\">{{ renderCustomerName(conversation.data) }}</div>\n              <div v-if=\"conversation.lastMessage.type === 'text'\" class=\"item-info-message\">{{\n                  conversation.lastMessage.payload.text\n                }}\n              </div>\n              <div v-else-if=\"conversation.lastMessage.type === 'image'\" class=\"item-info-message\">\n                [图片消息]\n              </div>\n              <div v-else-if=\"conversation.lastMessage.type === 'video'\" class=\"item-info-message\">\n                [视频消息]\n              </div>\n              <div v-else-if=\"conversation.lastMessage.type === 'audio'\" class=\"item-info-message\">\n                [语音消息]\n              </div>\n              <div v-else-if=\"conversation.lastMessage.type === 'order'\" class=\"item-info-message\">\n                [自定义消息:订单]\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"conversation-list-item\">\n        <div class=\"conversation-list-title\">已接入 {{ conversations.length }}</div>\n        <div v-if=\"conversations.length\" class=\"conversation-list-body\">\n          <div\n            v-for=\"(conversation, key) in conversations\"\n            :key=\"key\" :class=\"{checked:conversation.id === $route.query.id}\"\n            class=\"conversation-item\"\n            @click=\"chat(conversation.id)\"\n            @contextmenu.prevent.stop=\"e => showRightClickMenu(e,conversation)\"\n          >\n            <div class=\"item-head\">\n              <img v-if=\"conversation.data.avatar\" class=\"item-avatar\" :src=\"conversation.data.avatar\"/>\n              <img v-else class=\"item-avatar\" src=\"../images/default.png\"/>\n              <span class=\"item-unread-num\" v-if=\"conversation.unread\">{{conversation.unread}}</span>\n            </div>\n            <div class=\"item-info\">\n              <div class=\"item-info-top\">\n                <div class=\"item-info-name\">{{ renderCustomerName(conversation.data) }}</div>\n                <div class=\"item-info-time\">{{ formatDate(conversation.lastMessage.timestamp) }}</div>\n              </div>\n              <div class=\"item-info-bottom\">\n                <div v-if=\"conversation.lastMessage.status === 'sending'\"\n                     class=\"item-info-sending\"></div>\n                <div v-if=\"conversation.lastMessage.status === 'fail'\" class=\"item-info-failed\"></div>\n                <div v-if=\"conversation.lastMessage.type === 'text'\" class=\"item-info-message\">{{\n                    conversation.lastMessage.payload.text\n                  }}\n                </div>\n                <div v-else-if=\"conversation.lastMessage.type === 'image'\" class=\"item-info-message\">\n                  [图片消息]\n                </div>\n                <div v-else-if=\"conversation.lastMessage.type === 'video'\" class=\"item-info-message\">\n                  [视频消息]\n                </div>\n                <div v-else-if=\"conversation.lastMessage.type === 'audio'\" class=\"item-info-message\">\n                  [语音消息]\n                </div>\n                <div v-else-if=\"conversation.lastMessage.type === 'order'\" class=\"item-info-message\">\n                  [自定义消息:订单]\n                </div>\n                <div v-else-if=\"conversation.lastMessage.type === 'CS_END'\" class=\"item-info-message\">\n                  会话已结束\n                </div>\n                <div v-else-if=\"conversation.lastMessage.type === 'CS_ACCEPT'\"\n                     class=\"item-info-message\">接入成功\n                </div>\n                <div v-else-if=\"conversation.lastMessage.type === 'CS_TRANSFER'\"\n                     class=\"item-info-message\">\n                  {{\n                    conversation.lastMessage.senderId === currentAgent.id ? `已转接给` +\n                      conversation.lastMessage.payload.transferTo.data.name : '已接入来自' +\n                      conversation.lastMessage.senderData.name + '的转接'\n                  }}\n                </div>\n                <div v-else class=\"item-info-message\">[未识别内容]</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div v-if=\"rightClickMenu.visible\" :style=\"{'left': rightClickMenu.x + 'px', 'top': rightClickMenu.y + 'px'}\"\n           class=\"action-box\">\n        <div class=\"action-item\" @click=\"topConversation\">{{ rightClickMenu.conversation.top ? '取消置顶' : '置顶' }}</div>\n        <div class=\"action-item\" @click=\"deleteConversation\">删除聊天</div>\n      </div>\n    </div>\n    <div class=\"conversation-main\">\n      <router-view :key=\"$route.query.id\"></router-view>\n    </div>\n  </div>\n</template>\n\n<script>\n  import {formatDate} from '../lib/utils.js'\n  export default {\n    name: 'Conversation',\n    data() {\n      return {\n        pendingConversations: [],\n        conversations: [],\n        // Conversation右键菜单\n        rightClickMenu: {\n          conversation: null,\n          visible: false,\n          x: null,\n          y: null,\n        },\n        currentAgent: null\n      }\n    },\n    created() {\n      //隐藏Conversation右键菜单\n      document.addEventListener('click', () => {\n        this.hideRightClickMenu();\n      });\n      this.currentAgent = this.global.currentAgent;\n      this.listenConversationUpdate(); //监听会话列表变化\n      this.loadConversations(); //加载会话列表\n    },\n    beforeDestroy() {\n      this.global.goEasy.im.off(this.global.GoEasy.IM_EVENT.CONVERSATIONS_UPDATED, this.renderLatestConversations);\n      this.global.goEasy.im.off(this.global.GoEasy.IM_EVENT.PENDING_CONVERSATIONS_UPDATED, this.renderPendingConversations);\n    },\n    methods: {\n      formatDate,\n      renderCustomerName (customer) {\n        if (customer.mark) {\n          return customer.mark;\n        } else if (customer.name.indexOf('游客') !== -1 && customer.mobileNumber || !customer.name) {\n          return customer.mobileNumber;\n        }\n        return customer.mobileNumber || customer.name;\n      },\n      loadConversations() {\n        this.global.goEasy.im.pendingConversations({\n          onSuccess: (result) => {\n            this.renderPendingConversations(result.content);\n          },\n          onFailed: (error) => {\n            console.log('获取待接入列表失败, code:' + error.code + 'content:' + error.content);\n          },\n        });\n        this.global.goEasy.im.latestConversations({\n          onSuccess: (result) => {\n            this.renderLatestConversations(result.content);\n          },\n          onFailed: (error) => {\n            console.log('获取已接入列表失败, code:' + error.code + 'content:' + error.content);\n          },\n        });\n      },\n      listenConversationUpdate() {\n        // 监听会话列表变化\n        this.global.goEasy.im.on(this.global.GoEasy.IM_EVENT.CONVERSATIONS_UPDATED, this.renderLatestConversations);\n        this.global.goEasy.im.on(this.global.GoEasy.IM_EVENT.PENDING_CONVERSATIONS_UPDATED, this.renderPendingConversations);\n      },\n      renderPendingConversations(content) {\n        this.pendingConversations = content.conversations;\n      },\n      renderLatestConversations(content) {\n        this.conversations = content.conversations;\n      },\n      chat(customerId) {\n        this.$router.push({\n          path: '/agent/conversations/chat',\n          query: {\n            id: customerId,\n          }\n        });\n      },\n      showRightClickMenu(e, conversation) {\n        this.rightClickMenu.conversation = conversation;\n        this.rightClickMenu.visible = true;\n        this.rightClickMenu.x = e.pageX;\n        this.rightClickMenu.y = e.pageY;\n      },\n      hideRightClickMenu() {\n        this.rightClickMenu.visible = false;\n      },\n      topConversation() {\n        let conversation = this.rightClickMenu.conversation;\n        let description = conversation.top ? '取消置顶' : '置顶';\n        this.global.goEasy.im.topConversation({\n          top: !conversation.top,\n          conversation: conversation,\n          onSuccess: function () {\n            console.log(description, '成功');\n          },\n          onFailed: function (error) {\n            console.log(description, '失败：', error);\n          },\n        });\n      },\n      deleteConversation() {\n        let confirmResult = confirm('确认要删除这条会话吗？');\n        if (confirmResult===true) {\n          this.global.goEasy.im.removeConversation({\n            conversation: this.rightClickMenu.conversation,\n            onSuccess: function () {\n              console.log('删除会话成功');\n            },\n            onFailed: function (error) {\n              console.log(error);\n            },\n          });\n        }\n      }\n    }\n  }\n</script>\n\n<style lang=\"scss\" scoped>\n  .conversation-container {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    background: #FFFFFF;\n\n    .conversation-list {\n      width: 240px;\n      border-right: 1px solid #eee;\n      display: flex;\n      flex-direction: column;\n      padding: 10px;\n      position: relative;\n\n      .conversation-list-item {\n        .conversation-list-title {\n          font-size: 16px;\n          margin: 10px;\n          color: rgba(0, 0, 0, .9);\n        }\n\n        .conversation-list-body {\n          overflow-y: auto;\n          max-height: 240px;\n\n          &::-webkit-scrollbar { // Chrome Safari\n            display: none;\n          }\n\n          scrollbar-width: none; // firefox\n          -ms-overflow-style: none; // IE 10+\n        }\n      }\n\n      .action-box {\n        width: 100px;\n        height: 60px;\n        background: #ffffff;\n        border: 1px solid #cccccc;\n        position: fixed;\n        z-index: 100;\n        border-radius: 5px;\n      }\n\n      .action-item {\n        padding-left: 15px;\n        line-height: 30px;\n        font-size: 13px;\n        color: #262628;\n        cursor: pointer;\n\n        &:hover {\n          background: #dddddd;\n        }\n      }\n\n      .conversation-item {\n        display: flex;\n        padding: 12px;\n        cursor: pointer;\n\n        .item-head {\n          position: relative;\n          margin-right: 5px;\n        }\n\n        .item-avatar {\n          width: 45px;\n          height: 45px;\n          border-radius: 4px;\n        }\n\n        .item-unread-num {\n          position: absolute;\n          top: -9px;\n          right: -9px;\n          width: 18px;\n          height: 18px;\n          line-height: 18px;\n          border-radius: 50%;\n          text-align: center;\n          color: #fff;\n          font-size: 12px;\n          background-color: #fa5151;\n        }\n\n        .item-info {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          justify-content: space-between;\n\n          .item-info-top {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n          }\n\n          .item-info-name {\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            word-break: break-all;\n            font-size: 15px;\n            width: 180px;\n            line-height: 25px;\n            color: #333333;\n          }\n\n          .item-info-time {\n            color: #999999;\n            font-size: 12px;\n            word-break: break-word;\n          }\n\n          .item-info-bottom {\n            display: flex;\n            align-items: center;\n\n            .more-action {\n              font-size: 18px;\n              cursor: pointer;\n            }\n\n          }\n\n          .item-info-message {\n            font-size: 12px;\n            line-height: 20px;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n            width: 150px;\n            color: #606266;\n          }\n\n          .item-info-failed {\n            background: url(\"../images/failed.png\") no-repeat center;\n            background-size: 12px;\n            width: 12px;\n            height: 12px;\n            margin-right: 2px;\n          }\n\n          .item-info-sending {\n            background: url(\"../images/pending.gif\") no-repeat center;\n            background-size: 12px;\n            width: 12px;\n            height: 12px;\n            margin-right: 2px;\n          }\n\n        }\n      }\n\n      .checked {\n        background: #eeeeee;\n        border-radius: 5px;\n      }\n\n    }\n\n    .conversation-main {\n      flex: 1;\n      background: #FFFFFF;\n    }\n\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Conversations.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Conversations.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Conversations.vue?vue&type=template&id=58bb661c&scoped=true&\"\nimport script from \"./Conversations.vue?vue&type=script&lang=js&\"\nexport * from \"./Conversations.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Conversations.vue?vue&type=style&index=0&id=58bb661c&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"58bb661c\",\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"img/default.f0e98eaa.png\";","/**\n * 格式化日期\n * @prama t 时间戳\n * @return str MM-dd HH:mm\n */\nexport function formatDate(t) {\n    t = t || Date.now();\n    let time = new Date(t);\n    let str = time.getMonth() < 9 ? '0' + (time.getMonth() + 1) : time.getMonth() + 1;\n    str += '-';\n    str += time.getDate() < 10 ? '0' + time.getDate() : time.getDate();\n    str += ' ';\n    str += time.getHours();\n    str += ':';\n    str += time.getMinutes() < 10 ? '0' + time.getMinutes() : time.getMinutes();\n    return str;\n}\n\n/**\n * 格式化日期\n * @prama t 时间戳\n * @return str YY-MM-dd HH:mm\n */\nexport function formateFullDate(t) {\n    t = t || Date.now();\n    let time = new Date(t);\n    let str = time.getFullYear();\n    str += '-';\n    str += time.getMonth() < 9 ? '0' + (time.getMonth() + 1) : time.getMonth() + 1;\n    str += '-';\n    str += time.getDate() < 10 ? '0' + time.getDate() : time.getDate();\n    str += ' ';\n    str += time.getHours();\n    str += ':';\n    str += time.getMinutes() < 10 ? '0' + time.getMinutes() : time.getMinutes();\n    str += ':';\n    str += time.getSeconds() < 10 ? '0' + time.getSeconds() : time.getSeconds();\n    return str;\n}\n\n/**\n * 距当前时间点的时长\n * @prama time 13位时间戳\n * @return str x秒 / x分钟 / x小时\n */\nexport function formateTime(time) {\n    const second = 1000;\n    const minute = second * 60;\n    const hour = minute * 60;\n    const day = hour * 24;\n    const now = new Date().getTime();\n    const diffValue = now - time;\n\n    // 计算差异时间的量级\n    const secondC = diffValue / second;\n    const minC = diffValue / minute;\n    const hourC = diffValue / hour;\n    const dayC = diffValue / day;\n\n    if (dayC >= 1) {\n        return parseInt(dayC) + \"天\";\n    } else if (hourC >= 1) {\n        return parseInt(hourC) + \"小时\";\n    } else if (minC >= 1) {\n        return parseInt(minC) + \"分钟\";\n    } else if (secondC >= 1) {\n        return parseInt(secondC) + \"秒\";\n    } else {\n        return '0秒';\n    }\n}","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Conversations.vue?vue&type=style&index=0&id=58bb661c&prod&lang=scss&scoped=true&\""],"sourceRoot":""}